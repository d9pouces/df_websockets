(()=>{var e={66:()=>{window.DFSignals={connection:null,buffer:[],registry:{},wsurl:null},document.addEventListener("DOMContentLoaded",(function e(){const n="dfwsurl",t="--heartbeat--";if(null===window.DFSignals.wsurl){const e=function(e){const n=e+"=",t=decodeURIComponent(document.cookie).split(";");for(let e=0;e<t.length;e++){let o=t[e];for(;" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(n))return o.substring(8,o.length)}return""}(n);window.DFSignals.wsurl=decodeURIComponent(e)}if(!window.DFSignals.wsurl)return void console.info("Unable to get the websocket URL in the '"+n+"' cookie.");const o=new WebSocket(window.DFSignals.wsurl);o.heartbeatInterval=null,o.onopen=()=>{window.DFSignals.connection=o;for(let e=0;e<window.DFSignals.buffer.length;e++)o.send(window.DFSignals.buffer[e]);o.heartbeatInterval=setInterval(o.sendHeartbeat,5e3),window.DFSignals.buffer=[]},o.sendHeartbeat=()=>{try{o.send(t)}catch(e){console.warn("Unable to send heartbeat, reason: "+e.message)}},o.onmessage=e=>{if(e.data===t)return void console.debug("heartbeat received");console.debug("received call "+e.data+" from server.");const n=JSON.parse(e.data);n.signal&&n.signal_id&&window.DFSignals.call(n.signal,n.opts,n.signal_id)},o.onerror=e=>{console.error("WS error: "+e)},o.onclose=n=>{window.DFSignals.connection=null,null!==o.heartbeatInterval&&clearInterval(o.heartbeatInterval),console.debug("WebSocket connection closed: "+n.code+" "+n.reason),setTimeout(e,3e3)},addEventListener("beforeunload",(()=>{o.close()}))})),window.DFSignals.call=function(e,n,t){if(void 0!==t&&void 0!==window.DFSignals.registry[t])return!1;if(void 0!==t&&(window.DFSignals.registry[t]=!0),void 0!==window.DFSignals.registry[e]){console.debug('call "'+e+'"',n);for(let o=0;o<window.DFSignals.registry[e].length;o+=1)window.DFSignals.registry[e][o](n,t)}if(void 0===t){console.debug('call from client: "'+e+'"',n);const t=JSON.stringify({signal:e,opts:n});window.DFSignals.connection?window.DFSignals.connection.send(t):window.DFSignals.buffer.push(t)}return!1},window.DFSignals.connect=function(e,n){void 0===window.DFSignals.registry[e]&&(window.DFSignals.registry[e]=[]),window.DFSignals.registry[e].push(n)}},841:(e,n,t)=>{"use strict";var o=t(894);const l=e=>{document.querySelectorAll(e.selector).forEach((n=>{const t=n.nextSibling;n.insertAdjacentHTML("afterend",e.content);let o=n.nextSibling;for(;o&&o!==t;)o.querySelectorAll&&o.dispatchEvent(new Event("DOMContentAdded",{bubbles:!0})),o=o.nextSibling}))},r=e=>{document.querySelectorAll(e.selector).forEach((n=>{const t=n.lastChild;n.insertAdjacentHTML("beforeend",e.content);let o=n.lastChild;for(;o&&o!==t;)o.querySelectorAll&&o.dispatchEvent(new Event("DOMContentAdded",{bubbles:!0})),o=o.previousSibling}))},i=e=>{document.querySelectorAll(e.selector).forEach((n=>{const t=n.firstChild;n.insertAdjacentHTML("afterbegin",e.content);let o=n.firstChild;for(;o&&o!==t;)o.querySelectorAll&&o.dispatchEvent(new Event("DOMContentAdded",{bubbles:!0})),o=o.nextSibling}))},c=e=>{document.querySelectorAll(e.selector).forEach((n=>{const t=n.previousSibling;n.insertAdjacentHTML("beforebegin",e.content);let o=n.previousSibling;for(;o&&o!==t;)o.querySelectorAll&&o.dispatchEvent(new Event("DOMContentAdded",{bubbles:!0})),o=o.previousSibling}))},a=e=>{document.querySelectorAll(e.selector).forEach((n=>{n.innerHTML=e.content;let t=n.firstChild;for(;t;)t.querySelectorAll&&t.dispatchEvent(new Event("DOMContentAdded",{bubbles:!0})),t=t.nextSibling}))},s=e=>{document.querySelectorAll(e.selector).forEach((n=>{const t=n.previousSibling,o=n.nextSibling,l=n.parentNode;n.outerHTML=e.content;let r=l.firstChild;for(t&&(r=t.nextSibling);r&&r!==o;)r.querySelectorAll&&r.dispatchEvent(new Event("DOMContentAdded",{bubbles:!0})),r=r.nextSibling}))},d=e=>{document.querySelectorAll(e.selector).forEach((e=>{for(;e.firstChild;)e.removeChild(e.firstChild)}))},u=e=>{document.querySelectorAll(e.selector).forEach((e=>{e.parentNode.removeChild(e)}))},f=e=>{document.querySelectorAll(e.selector).forEach((n=>{n.textContent=e.content}))};(()=>{const e=e=>{document.querySelectorAll(e.selector).forEach((n=>{n.classList.add(e.class_name)}))},n=e=>{document.querySelectorAll(e.selector).forEach((n=>{n.classList.remove(e.class_name)}))},t=e=>{document.querySelectorAll(e.selector).forEach((n=>{n.removeAttribute(e.attr_name)}))},w=e=>{document.querySelectorAll(e.selector).forEach((n=>{n.setAttribute(e.attr_name,e.attr_value)}))},g=e=>{document.querySelectorAll(e.selector).forEach((n=>{e.value?n.setAttribute(e.name,e.name):n.removeAttribute(e.name)}))},h=e=>{const n=document.createElement("a");n.href=e.url,n.target="_blank",n.download=e.filename||"unknown";const t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});n.dispatchEvent(t),(window.URL||window.webkitURL).revokeObjectURL(n.href)},m=e=>{const n=document.querySelector(e.selector);n&&n.focus({preventScroll:!1})};document.addEventListener("DOMContentLoaded",(function(){window.DFSignals.connect("html.after",l),window.DFSignals.connect("html.append",r),window.DFSignals.connect("html.prepend",i),window.DFSignals.connect("html.before",c),window.DFSignals.connect("html.content",a),window.DFSignals.connect("html.replace_with",s),window.DFSignals.connect("html.empty",d),window.DFSignals.connect("html.remove",u),window.DFSignals.connect("html.add_class",e),window.DFSignals.connect("html.remove_class",n),window.DFSignals.connect("html.remove_attr",t),window.DFSignals.connect("html.add_attribute",w),window.DFSignals.connect("html.boolean_attribute",g),window.DFSignals.connect("html.text",f),window.DFSignals.connect("html.download_file",h),window.DFSignals.connect("html.focus",m),window.DFSignals.connect("html.forms.set",o.R)}))})()},894:(e,n,t)=>{"use strict";function o(e){document.querySelectorAll(e.selector).forEach((function(n){e.values.forEach((function(e){!function(e,n,t){var o=e.elements.namedItem(n);if(null!==o)if(o instanceof RadioNodeList)if(!0===t||!1===t)o.forEach((function(e){e.checked=t}));else if(Array.isArray(t)){var l=new Set(t);o.forEach((function(e){e.checked=l.has(e.value)}))}else o.forEach((function(e){e.checked=e.value===t}));else if(o instanceof HTMLTextAreaElement)o.value=t;else if(o instanceof HTMLInputElement&&"checkbox"===o.type)!0===t?o.checked=!0:!1===t?o.checked=!1:o.value=t;else if(o instanceof HTMLSelectElement){var r=o.options;if(Array.isArray(t))for(var i=new Set(t),c=0;c<r.length;c++)r[c].selected=i.has(r[c].value);else for(c=0;c<r.length;c++)r[c].selected=r[c].value===t}else o instanceof HTMLInputElement&&(o.value=t)}(n,e.name,e.value)}))}))}t.d(n,{R:()=>o}),function(){function e(e){e.target.querySelectorAll&&e.target.querySelectorAll("[data-df-signal]").forEach((function(e){JSON.parse(e.getAttribute("data-df-signal")).forEach((function(n){var t=n.on;t||(t="FORM"===e.tagName?"submit":"INPUT"===e.tagName&&"reset"!==e.type&&"submit"!==e.type&&"button"!==e.type||"TEXTAREA"===e.tagName?"change":"click"),e.addEventListener(t,(function(o){var l=n.prevent,r=n.opts||{};if(n.form&&(r[n.form]=function(e){for(var n=[],t=0;t<e.elements.length;t++){var o=e.elements[t];if(o.name&&!o.disabled&&"reset"!==o.type&&"submit"!==o.type&&"button"!==o.type)if("file"===o.type)for(var l=0;l<o.files.length;l++)n.push({name:o.name,value:o.files[l].name});else if("select-multiple"===o.type)for(l=0;l<o.selectedOptions.length;l++)n.push({name:o.name,value:o.selectedOptions[l].value});else("checkbox"!==o.type&&"radio"!==o.type||o.checked)&&n.push({name:o.name,value:o.value})}return n}(e)),n.value)if("file"===e.type){r[n.value]=[];for(var i=0;i<e.files.length;i++)r[n.value].push(e.files[i].name)}else if("select-multiple"===e.type)for(r[n.value]=[],i=0;i<e.selectedOptions.length;i++)r[n.value].push(e.selectedOptions[i].value);else"checkbox"===e.type||"radio"===e.type?r[n.value]=e.checked:r[n.value]=e.value;window.DFSignals.call(n.name,r,void 0),(!0===l||null===l&&"change"!==t)&&o.preventDefault()}))}))}))}document.addEventListener("DOMContentAdded",(function(n){window.setTimeout((function(){e(n)}),50)})),document.addEventListener("DOMContentLoaded",(function(n){window.setTimeout((function(){e(n)}),50)}))}()}},n={};function t(o){var l=n[o];if(void 0!==l)return l.exports;var r=n[o]={exports:{}};return e[o](r,r.exports,t),r.exports}t.d=(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t(66),t(841),t(894)})();
//# sourceMappingURL=df_websockets.min.js.map